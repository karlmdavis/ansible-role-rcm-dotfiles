---
- hosts: localhost
  connection: local
  tasks:
    - name: Create Test User
      user:
        name: ansible_test

    - name: Add GitHub to the Global ssh_known_hosts
      known_hosts:
        path: /etc/ssh/ssh_known_hosts
        name: github.com
        # This file was generated by running this command: ssh-keyscan -t rsa github.com > github.com.rsa.pub
        key: "{{ lookup('file', 'github.com.rsa.pub') }}"
      become: true

    - name: Install and Configure RCM
      include_role:
        name: karlmdavis.rcm
      vars:
        rcm_user: ansible_test
        rcm_install_mode: no_internet
        rcm_repos:
          - repo: 'git@github.com:karlmdavis/dotfiles.git'
            dest: '/home/karl/.dotfiles-karlmdavis.git'

